!function(e){function t(e){clearTimeout(e),e=null}e.fn.smartSuggest=function(s){var a={boxId:"%-suggestions",classPrefix:"ss-",timeoutLength:250,src:"",resultsText:"$ od % rezultata",noResultsText:"Nema rezultata.",showEmptyCategories:!1,fillBox:!1,fillBoxWith:"primary",executeCode:!0,showImages:!0,minChars:2},s=e.extend(a,s);s.boxId=s.boxId.replace("%",e(this).attr("id"));var i="";e(this).wrap('<div class="'+s.classPrefix+'wrap"></div>'),e(this).attr("autocomplete","off"),e(this).after('<ul class="'+s.classPrefix+'box" id="'+s.boxId+'" style="display: none;"></ul>');var l=e(this),r=e("#"+s.boxId),n=null;l.keyup(function(a){if(13!=a.keyCode&&9!=a.keyCode){var o=l.val();""==o||o.length<s.minChars?(r.fadeOut(),t(n)):(null!=n&&t(n),n=setTimeout(function(){l.addClass(s.classPrefix+"input-thinking"),i=o,e.getJSON(s.src+"?q="+o,function(t,a){if("success"==a){var i="",n=!1;e.each(t,function(e,t){t.data.length>0&&(n=!0)}),n?e.each(t,function(t,a){if(s.showEmptyCategories||!s.showEmptyCategories&&0!=a.data.length){var r=a.header.limit,n=0;i+='<li class="'+s.classPrefix+'header">\n',i+='<p class="'+s.classPrefix+'header-text">'+a.header.title+"</p>\n",i+='<p class="'+s.classPrefix+'header-limit">'+s.resultsText.replace("%",a.header.num).replace("$",a.header.limit<a.data.length?a.header.limit:a.data.length)+"</p>\n",i+="</li>";var o=s.fillBox?"document.getElementById('"+l.attr("id")+"').value = '%';":"";e.each(a.data,function(e,t){if(r>n){var a='<a href="';a+=void 0!=t.url?t.url:"javascript: void(0);",a+='" ',a+=void 0!=t.onclick?' onclick="'+o.replace("%",t[s.fillBoxWith])+(s.executeCode?t.onclick:"")+'" ':"",a+=">",i+='<li class="'+s.classPrefix+'result">'+a+"\n",i+='<table border="0" cellspacing="0" cellpadding="0" width="100%"><tr>',i+=void 0!=t.image&&s.showImages?'<td width="40"><img src="'+t.image+'" /></td>\n':"",i+="<td>",i+="<p>",i+=void 0!=t.primary?'<span class="'+s.classPrefix+'result-title">'+t.primary+"</span><br />\n":"",i+=void 0!=t.secondary?""+t.secondary+"\n":"",i+="</p>\n",i+="</td>",i+="</tr></table>",i+="</a></li>\n"}n++})}}):(i+='<li class="'+s.classPrefix+'header">\n',i+='<p class="'+s.classPrefix+'header-text">'+s.noResultsText+"</p>\n",i+='<p class="'+s.classPrefix+'header-limit">0 rezultata</p>\n',i+="</li>"),r.html(i),r.css("position","absolute"),r.css("top",l.offset().top+l.outerHeight()),r.css("left",l.offset().left),r.fadeIn(),l.removeClass(s.classPrefix+"input-thinking")}})},s.timeoutLength))}}),l.blur(function(){r.fadeOut()}),l.focus(function(){l.val()==i&&""!=l.val()&&r.fadeIn()})}}(jQuery);